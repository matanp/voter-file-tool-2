# T1.1 handleRequest Route Tests

**Status:** Done
**Roadmap:** [SRS_IMPLEMENTATION_ROADMAP.md](../SRS_IMPLEMENTATION_ROADMAP.md) Testing Tier 1 §T1.1
**Effort:** 0.5–1 day
**Depends on:** Nothing (can run in parallel with Phase 1)

## Summary

Add automated tests for the `handleRequest` route — the accept/reject workflow for committee requests. This route is high-risk (data integrity, membership lifecycle) and currently has zero coverage.

## Acceptance Criteria

- [x] Authentication and authorization (Admin only)
- [x] Accept flow: member gets connected, request deleted, capacity check (>= maxSeatsPerLted rejection)
- [x] Reject flow: request deleted, no member change
- [x] Replacement flow (remove + add in one request)
- [x] Invalid request ID (404)
- [x] Already-processed request (idempotency) — covered via 404 when request not found (same behavior as double-submit)

## Implementation Notes

- **File to test:** `apps/frontend/src/app/api/committee/handleRequest/route.ts`
- **Tests file:** `apps/frontend/src/__tests__/api/committee/handleRequest.test.ts` (may already exist — verify coverage)
- **Pattern:** Follow existing test patterns in `add.test.ts` and `remove.test.ts`
- **Pre-migration fix:** Fix `CommitteeRequest.committList` schema typo (missing 't') before or during CommitteeRequest deprecation. Rename relation to `committeeList` and column to `committeeListId` if not already correct. See [CODE_REVIEW_RECOMMENDATIONS.md](../../CODEBASE_AUDIT/CODE_REVIEW_RECOMMENDATIONS.md)

## Related

- [SRS_IMPLEMENTATION_ROADMAP.md](../SRS_IMPLEMENTATION_ROADMAP.md) Testing Tier 1 §T1.1
- [TEST_REVIEW_GAPS.md](../../CODEBASE_AUDIT/TEST_REVIEW_GAPS.md)
