# 1.R.5 Source-of-Truth Split: committeeMemberList vs CommitteeMembership (P1)

**Status:** Resolved
**Priority:** P1 — High
**Effort:** 2–3 days
**Depends on:** [1.2 CommitteeMembership Model](1.2-committee-membership-model.md), [1.R.4 Bulk Import](1.R.4-bulk-import-phase1-incompatible.md)

## Summary

Key flows still write/read the deprecated `committeeMemberList` (VoterRecord ↔ CommitteeList relation) while Phase 1 routes use `CommitteeMembership`. `fetchCommitteeList` (frontend API) was updated to read memberships, but `handleCommitteeDiscrepancy` accept still connects `committeeMemberList`, and the report-server reads `committeeMemberList`. Committee mutations done via Phase 1 routes (add, requestAdd, handleRequest) can diverge from imports, discrepancy resolution, and report outputs.

## Current State

| Flow | Source | Notes |
|------|--------|-------|
| `fetchCommitteeList` (route) | CommitteeMembership | Reads memberships (route.ts line 71) |
| `handleCommitteeDiscrepancy` accept | committeeMemberList | Connects to committeeMemberList (route.ts line 53) |
| Report-server `fetchCommitteeData` | committeeMemberList | committeeMappingHelpers.ts line 102 `include: { committeeMemberList: true }` |
| Bulk import | VoterRecord.committeeId | See [1.R.4](1.R.4-bulk-import-phase1-incompatible.md) |

## Acceptance Criteria

- [x] **handleCommitteeDiscrepancy accept:** Create/update `CommitteeMembership` with `status=ACTIVE` (and seat assignment) instead of connecting `committeeMemberList`. Stop using `committeeMemberList.connect`.
- [x] **Report-server:** Update `fetchCommitteeData` and `mapCommitteesToReportShape` to read from `CommitteeMembership` (join through voterRecordId) instead of `committeeMemberList`. Filter by `status=ACTIVE` (and term).
- [x] **Schema deprecation:** Add comment or migration plan for eventual removal of `committeeMemberList` and `VoterRecord.committeeId`; ensure no remaining writers.
- [x] **Tests:** Update `fetchCommitteeList`, `handleCommitteeDiscrepancy`, and report-generation tests to assert CommitteeMembership as source.
- [x] Verify Phase 1 mutations (add, requestAdd, handleRequest) are reflected in discrepancy resolution and reports.

## Implementation Notes

- **Files:** 
  - `apps/frontend/src/app/api/admin/handleCommitteeDiscrepancy/route.ts`
  - `apps/report-server/src/committeeMappingHelpers.ts`
- **CommitteeMembership → VoterRecord:** Include `voterRecord` relation when building member list for reports.
- Coordinate with [1.R.4](1.R.4-bulk-import-phase1-incompatible.md) so bulk import also writes CommitteeMembership.

## Related

- [1.2 CommitteeMembership Model](1.2-committee-membership-model.md)
- [1.R.4 Bulk Import](1.R.4-bulk-import-phase1-incompatible.md)
- [T1.2 Report Generation API Tests](T1.2-report-generation-api-tests.md)
